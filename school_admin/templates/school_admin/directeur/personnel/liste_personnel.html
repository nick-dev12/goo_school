<!DOCTYPE html>
{% load static %}
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gestion du Personnel - {{ etablissement.nom }}</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="{% static 'school_admin/css/directeur/header_directeur.css' %}"
    />
    <link
      rel="stylesheet"
      href="{% static 'school_admin/css/directeur/liste_personnel.css' %}"
    />
  </head>
  <body>
    <!-- Header -->
    {% include 'school_admin/directeur/partials/header_directeur.html' %}

    <!-- Main Content -->
    <div class="main-content-container">
      <!-- Page Header -->
      <div class="page-header">
        <div class="page-title-section">
          <h1 class="page-title">
            <i class="fas fa-users"></i>
            Gestion du Personnel
          </h1>
          <p class="page-subtitle">
            Gérez tous les membres de votre équipe éducative
          </p>
        </div>
        <div class="page-actions">
          <a href="{% url 'professeur:ajouter_professeur' %}" class="btn-add btn-primary">
            <i class="fas fa-chalkboard-teacher"></i>
            <span>Ajouter un professeur</span>
          </a>
          <a href="{% url 'personnel:ajouter_personnel' %}" class="btn-add btn-secondary">
            <i class="fas fa-user-tie"></i>
            <span>Ajouter du personnel</span>
          </a>
        </div>
      </div>

      <!-- Onglets -->
      <div class="tabs-container">
        <div class="tabs-nav">
          <button class="tab-btn active" data-tab="professeurs">
            <i class="fas fa-chalkboard-teacher"></i>
            <span>Professeurs</span>
            <span class="tab-count" id="professeurs-count">0</span>
          </button>
          <button class="tab-btn" data-tab="secretaires">
            <i class="fas fa-user-tie"></i>
            <span>Secrétaires</span>
            <span class="tab-count" id="secretaires-count">0</span>
          </button>
          <button class="tab-btn" data-tab="censeurs">
            <i class="fas fa-graduation-cap"></i>
            <span>Censeurs</span>
            <span class="tab-count" id="censeurs-count">0</span>
          </button>
          <button class="tab-btn" data-tab="surveillants">
            <i class="fas fa-shield-alt"></i>
            <span>Surveillants</span>
            <span class="tab-count" id="surveillants-count">0</span>
          </button>
          <button class="tab-btn" data-tab="intendants">
            <i class="fas fa-cogs"></i>
            <span>Intendants</span>
            <span class="tab-count" id="intendants-count">0</span>
          </button>
        </div>
      </div>

      <!-- Contenu des onglets -->
      <div class="tabs-content">
        <!-- Onglet Professeurs -->
        <div class="tab-pane active" id="professeurs-pane">
          <div class="tab-header">
            <h2>Professeurs</h2>
            <p>Gérez les enseignants de votre établissement</p>
          </div>
          
          <!-- Menu déroulant pour les matières -->
          <div class="matiere-filter-container">
            <div class="filter-wrapper">
              <label for="matiere-select" class="filter-label">
                <i class="fas fa-filter"></i>
                Filtrer par matière
              </label>
              <select id="matiere-select" class="matiere-select">
                <option value="all">Toutes les matières ({{ stats.total_professeurs }})</option>
                {% for item in matieres_avec_compteurs %}
                  {% if item.count > 0 %}
                    <option value="{{ item.matiere.id }}">{{ item.matiere.nom }} ({{ item.count }})</option>
                  {% endif %}
                {% endfor %}
              </select>
            </div>
          </div>
          
          <div class="personnel-grid" id="professeurs-grid">
            {% for professeur in professeurs %}
              <div class="personnel-card professeur-card" data-matiere="{{ professeur.matiere_principale.id }}">
                <div class="card-header">
                  <div class="avatar">
                    <i class="fas fa-chalkboard-teacher"></i>
                  </div>
                  <div class="info">
                    <h3 class="name">{{ professeur.nom_complet }}</h3>
                    <p class="role">{{ professeur.matiere_display }}</p>
                    <span class="badge">{{ professeur.niveau_display }}</span>
                  </div>
                  <div class="status">
                    <span class="status-dot {% if professeur.actif %}active{% else %}inactive{% endif %}"></span>
                  </div>
                </div>
                <div class="card-content">
                  <div class="contact-info">
                    <div class="contact-item">
                      <i class="fas fa-envelope"></i>
                      <span>{{ professeur.email|truncatechars:25 }}</span>
                    </div>
                    <div class="contact-item">
                      <i class="fas fa-phone"></i>
                      <span>{{ professeur.telephone|truncatechars:15 }}</span>
                    </div>
                  </div>
                </div>
                <div class="card-actions">
                  <a href="{% url 'professeur:detail_professeur' professeur.id %}" class="action-btn primary" title="Voir détails">
                    <i class="fas fa-eye"></i>
                  </a>
                  <button class="action-btn secondary" onclick="alert('Fonctionnalité de modification à venir')" title="Modifier">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="action-btn {% if professeur.actif %}danger{% else %}success{% endif %}" onclick="alert('Fonctionnalité de toggle à venir')" title="{% if professeur.actif %}Désactiver{% else %}Activer{% endif %}">
                    <i class="fas fa-{% if professeur.actif %}pause{% else %}play{% endif %}"></i>
                  </button>
                </div>
              </div>
            {% empty %}
              <div class="empty-state">
                <div class="empty-icon">
                  <i class="fas fa-chalkboard-teacher"></i>
                </div>
                <h3>Aucun professeur</h3>
                <p>Commencez par ajouter des professeurs à votre équipe</p>
                <a href="{% url 'professeur:ajouter_professeur' %}" class="btn-add">
                  <i class="fas fa-plus"></i>
                  <span>Ajouter le premier professeur</span>
                </a>
              </div>
            {% endfor %}
          </div>
        </div>

        <!-- Onglet Secrétaires -->
        <div class="tab-pane" id="secretaires-pane">
          <div class="tab-header">
            <h2>Secrétaires</h2>
            <p>Gérez le personnel administratif</p>
          </div>
          <div class="personnel-grid" id="secretaires-grid">
            {% for membre in personnel %}
              {% if membre.fonction == 'secretaire' %}
                <div class="personnel-card">
                  <div class="card-header">
                    <div class="avatar">
                      <i class="fas fa-user-tie"></i>
                    </div>
                    <div class="info">
                      <h3 class="name">{{ membre.nom_complet }}</h3>
                      <p class="role">{{ membre.get_fonction_display }}</p>
                      <span class="badge">{{ membre.numero_employe }}</span>
                    </div>
                    <div class="status">
                      <span class="status-dot {% if membre.actif %}active{% else %}inactive{% endif %}"></span>
                    </div>
                  </div>
                  <div class="card-content">
                    <div class="contact-info">
                      <div class="contact-item">
                        <i class="fas fa-envelope"></i>
                        <span>{{ membre.email|truncatechars:25 }}</span>
                      </div>
                    </div>
                  </div>
                  <div class="card-actions">
                    <a href="{% url 'personnel:detail_personnel' membre.id %}" class="action-btn primary" title="Voir détails">
                      <i class="fas fa-eye"></i>
                    </a>
                    <a href="{% url 'personnel:toggle_actif' membre.id %}" class="action-btn {% if membre.actif %}danger{% else %}success{% endif %}" title="{% if membre.actif %}Désactiver{% else %}Activer{% endif %}">
                      <i class="fas fa-{% if membre.actif %}pause{% else %}play{% endif %}"></i>
                    </a>
                  </div>
                </div>
              {% endif %}
            {% empty %}
              <div class="empty-state">
                <div class="empty-icon">
                  <i class="fas fa-user-tie"></i>
                </div>
                <h3>Aucun secrétaire</h3>
                <p>Commencez par ajouter des secrétaires</p>
                <a href="{% url 'personnel:ajouter_personnel' %}" class="btn-add">
                  <i class="fas fa-plus"></i>
                  <span>Ajouter un secrétaire</span>
                </a>
              </div>
            {% endfor %}
          </div>
        </div>

        <!-- Onglet Censeurs -->
        <div class="tab-pane" id="censeurs-pane">
          <div class="tab-header">
            <h2>Censeurs</h2>
            <p>Gérez les censeurs de votre établissement</p>
          </div>
          <div class="personnel-grid" id="censeurs-grid">
            {% for membre in personnel %}
              {% if membre.fonction == 'censeur' %}
                <div class="personnel-card">
                  <div class="card-header">
                    <div class="avatar">
                      <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div class="info">
                      <h3 class="name">{{ membre.nom_complet }}</h3>
                      <p class="role">{{ membre.get_fonction_display }}</p>
                      <span class="badge">{{ membre.numero_employe }}</span>
                    </div>
                    <div class="status">
                      <span class="status-dot {% if membre.actif %}active{% else %}inactive{% endif %}"></span>
                    </div>
                  </div>
                  <div class="card-content">
                    <div class="contact-info">
                      <div class="contact-item">
                        <i class="fas fa-envelope"></i>
                        <span>{{ membre.email|truncatechars:25 }}</span>
                      </div>
                    </div>
                  </div>
                  <div class="card-actions">
                    <a href="{% url 'personnel:detail_personnel' membre.id %}" class="action-btn primary" title="Voir détails">
                      <i class="fas fa-eye"></i>
                    </a>
                    <a href="{% url 'personnel:toggle_actif' membre.id %}" class="action-btn {% if membre.actif %}danger{% else %}success{% endif %}" title="{% if membre.actif %}Désactiver{% else %}Activer{% endif %}">
                      <i class="fas fa-{% if membre.actif %}pause{% else %}play{% endif %}"></i>
                    </a>
                  </div>
                </div>
              {% endif %}
            {% empty %}
              <div class="empty-state">
                <div class="empty-icon">
                  <i class="fas fa-graduation-cap"></i>
                </div>
                <h3>Aucun censeur</h3>
                <p>Commencez par ajouter des censeurs</p>
                <a href="{% url 'personnel:ajouter_personnel' %}" class="btn-add">
                  <i class="fas fa-plus"></i>
                  <span>Ajouter un censeur</span>
                </a>
              </div>
            {% endfor %}
          </div>
        </div>

        <!-- Onglet Surveillants -->
        <div class="tab-pane" id="surveillants-pane">
          <div class="tab-header">
            <h2>Surveillants</h2>
            <p>Gérez les surveillants généraux</p>
          </div>
          <div class="personnel-grid" id="surveillants-grid">
            {% for membre in personnel %}
              {% if membre.fonction == 'surveillant_general' %}
                <div class="personnel-card">
                  <div class="card-header">
                    <div class="avatar">
                      <i class="fas fa-shield-alt"></i>
                    </div>
                    <div class="info">
                      <h3 class="name">{{ membre.nom_complet }}</h3>
                      <p class="role">{{ membre.get_fonction_display }}</p>
                      <span class="badge">{{ membre.numero_employe }}</span>
                    </div>
                    <div class="status">
                      <span class="status-dot {% if membre.actif %}active{% else %}inactive{% endif %}"></span>
                    </div>
                  </div>
                  <div class="card-content">
                    <div class="contact-info">
                      <div class="contact-item">
                        <i class="fas fa-envelope"></i>
                        <span>{{ membre.email|truncatechars:25 }}</span>
                      </div>
                    </div>
                  </div>
                  <div class="card-actions">
                    <a href="{% url 'personnel:detail_personnel' membre.id %}" class="action-btn primary" title="Voir détails">
                      <i class="fas fa-eye"></i>
                    </a>
                    <a href="{% url 'personnel:toggle_actif' membre.id %}" class="action-btn {% if membre.actif %}danger{% else %}success{% endif %}" title="{% if membre.actif %}Désactiver{% else %}Activer{% endif %}">
                      <i class="fas fa-{% if membre.actif %}pause{% else %}play{% endif %}"></i>
                    </a>
                  </div>
                </div>
              {% endif %}
            {% empty %}
              <div class="empty-state">
                <div class="empty-icon">
                  <i class="fas fa-shield-alt"></i>
                </div>
                <h3>Aucun surveillant</h3>
                <p>Commencez par ajouter des surveillants</p>
                <a href="{% url 'personnel:ajouter_personnel' %}" class="btn-add">
                  <i class="fas fa-plus"></i>
                  <span>Ajouter un surveillant</span>
                </a>
              </div>
            {% endfor %}
          </div>
        </div>

        <!-- Onglet Intendants -->
        <div class="tab-pane" id="intendants-pane">
          <div class="tab-header">
            <h2>Intendants</h2>
            <p>Gérez les intendants de votre établissement</p>
          </div>
          <div class="personnel-grid" id="intendants-grid">
            {% for membre in personnel %}
              {% if membre.fonction == 'administrateur' %}
                <div class="personnel-card">
                  <div class="card-header">
                    <div class="avatar">
                      <i class="fas fa-cogs"></i>
                    </div>
                    <div class="info">
                      <h3 class="name">{{ membre.nom_complet }}</h3>
                      <p class="role">{{ membre.get_fonction_display }}</p>
                      <span class="badge">{{ membre.numero_employe }}</span>
                    </div>
                    <div class="status">
                      <span class="status-dot {% if membre.actif %}active{% else %}inactive{% endif %}"></span>
                    </div>
                  </div>
                  <div class="card-content">
                    <div class="contact-info">
                      <div class="contact-item">
                        <i class="fas fa-envelope"></i>
                        <span>{{ membre.email|truncatechars:25 }}</span>
                      </div>
                    </div>
                  </div>
                  <div class="card-actions">
                    <a href="{% url 'personnel:detail_personnel' membre.id %}" class="action-btn primary" title="Voir détails">
                      <i class="fas fa-eye"></i>
                    </a>
                    <a href="{% url 'personnel:toggle_actif' membre.id %}" class="action-btn {% if membre.actif %}danger{% else %}success{% endif %}" title="{% if membre.actif %}Désactiver{% else %}Activer{% endif %}">
                      <i class="fas fa-{% if membre.actif %}pause{% else %}play{% endif %}"></i>
                    </a>
                  </div>
                </div>
              {% endif %}
            {% empty %}
              <div class="empty-state">
                <div class="empty-icon">
                  <i class="fas fa-cogs"></i>
                </div>
                <h3>Aucun intendant</h3>
                <p>Commencez par ajouter des intendants</p>
                <a href="{% url 'personnel:ajouter_personnel' %}" class="btn-add">
                  <i class="fas fa-plus"></i>
                  <span>Ajouter un intendant</span>
                </a>
              </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="{% static 'school_admin/js/directeur/liste_personnel.js' %}"></script>
  </body>
</html>
