<!DOCTYPE html>
{% load static %}
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Modifier {{ professeur.nom_complet }} - {{ etablissement.nom }}</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet"
    />
    <link
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        rel="stylesheet"
    />
    <link
        rel="stylesheet"
        href="{% static 'school_admin/css/directeur/header_directeur.css' %}"
    />
    <link
        rel="stylesheet"
        href="{% static 'school_admin/css/directeur/ajouter_professeur.css' %}"
    />
</head>
<body>
    <!-- Header -->
    {% include 'school_admin/directeur/partials/header_directeur.html' %}

    <!-- Main Content -->
    <div class="main-content-container">
        <!-- Page Header -->
        <div class="page-header">
            <div class="header-background">
                <div class="header-content">
                    <div class="page-title-section">
                        <div class="title-icon">
                            <i class="fas fa-user-edit"></i>
                        </div>
                        <div class="title-text">
                            <h1 class="page-title">Modifier {{ professeur.nom_complet }}</h1>
                            <p class="page-subtitle">
                                Modifiez les informations du professeur
                            </p>
                        </div>
                    </div>
                    <div class="page-actions">
                        <a href="{% url 'professeur:detail_professeur' professeur.id %}" class="btn-back btn-gradient">
                            <i class="fas fa-arrow-left"></i>
                            <span>Retour aux détails</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>

         <!-- Form Container -->
         <div class="form-container">
             <div class="form-card">
                 <div class="form-header">
                     <div class="form-title">
                         <div class="form-icon">
                             <i class="fas fa-edit"></i>
                         </div>
                         <h2>Modifier les informations</h2>
                     </div>
                 </div>
                 
                 <form method="post" action="{% url 'professeur:modifier_professeur' professeur.id %}" class="professeur-form" id="modifierProfesseurForm">
                     {% csrf_token %}
                    
                    <!-- Messages d'erreur généraux -->
                    {% if field_errors %}
                        <div class="alert alert-error">
                            <i class="fas fa-exclamation-triangle"></i>
                            <strong>Erreurs détectées :</strong> Veuillez corriger les champs marqués en rouge.
                        </div>
                    {% endif %}

                    <!-- Informations personnelles -->
                    <div class="form-section">
                        <div class="section-header">
                            <div class="section-icon">
                                <i class="fas fa-user"></i>
                            </div>
                            <h3 class="section-title">Informations personnelles</h3>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="nom">
                                    <i class="fas fa-id-card"></i>
                                    Nom de famille *
                                </label>
                                <input type="text" 
                                       class="form-control {% if field_errors.nom %}is-invalid{% endif %}" 
                                       id="nom" 
                                       name="nom" 
                                       value="{{ form_data.nom }}"
                                       placeholder="Ex: Dupont">
                                {% if field_errors.nom %}
                                    <span class="error-message">{{ field_errors.nom }}</span>
                                {% endif %}
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label" for="prenom">
                                    <i class="fas fa-user-tag"></i>
                                    Prénom *
                                </label>
                                <input type="text" 
                                       class="form-control {% if field_errors.prenom %}is-invalid{% endif %}" 
                                       id="prenom" 
                                       name="prenom" 
                                       value="{{ form_data.prenom }}"
                                       placeholder="Ex: Jean">
                                {% if field_errors.prenom %}
                                    <span class="error-message">{{ field_errors.prenom }}</span>
                                {% endif %}
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="email">
                                    <i class="fas fa-envelope"></i>
                                    Email *
                                </label>
                                <input type="email" 
                                       class="form-control {% if field_errors.email %}is-invalid{% endif %}" 
                                       id="email" 
                                       name="email" 
                                       value="{{ form_data.email }}"
                                       placeholder="Ex: jean.dupont@example.com">
                                {% if field_errors.email %}
                                    <span class="error-message">{{ field_errors.email }}</span>
                                {% endif %}
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label" for="telephone">
                                    <i class="fas fa-phone"></i>
                                    Téléphone *
                                </label>
                                <input type="tel" 
                                       class="form-control {% if field_errors.telephone %}is-invalid{% endif %}" 
                                       id="telephone" 
                                       name="telephone" 
                                       value="{{ form_data.telephone }}"
                                       placeholder="Ex: +33 6 12 34 56 78">
                                {% if field_errors.telephone %}
                                    <span class="error-message">{{ field_errors.telephone }}</span>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <!-- Informations professionnelles -->
                    <div class="form-section">
                        <div class="section-header">
                            <div class="section-icon">
                                <i class="fas fa-briefcase"></i>
                            </div>
                            <h3 class="section-title">Informations professionnelles</h3>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="matiere_principale">
                                    <i class="fas fa-book"></i>
                                    Matière principale *
                                </label>
                                <select class="form-control {% if field_errors.matiere_principale %}is-invalid{% endif %}" 
                                        id="matiere_principale" 
                                        name="matiere_principale">
                                    <option value="">-- Sélectionnez une matière --</option>
                                    {% for matiere in matieres %}
                                        <option value="{{ matiere.id }}" 
                                                {% if form_data.matiere_principale|stringformat:"s" == matiere.id|stringformat:"s" %}selected{% endif %}>
                                            {{ matiere.nom }}
                                        </option>
                                    {% endfor %}
                                </select>
                                {% if field_errors.matiere_principale %}
                                    <span class="error-message">{{ field_errors.matiere_principale }}</span>
                                {% endif %}
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label" for="niveau_enseignement">
                                    <i class="fas fa-graduation-cap"></i>
                                    Niveau d'enseignement *
                                </label>
                                <select class="form-control {% if field_errors.niveau_enseignement %}is-invalid{% endif %}" 
                                        id="niveau_enseignement" 
                                        name="niveau_enseignement">
                                    <option value="">-- Sélectionnez un niveau --</option>
                                    {% for value, label in niveau_choices %}
                                        <option value="{{ value }}" 
                                                {% if form_data.niveau_enseignement == value %}selected{% endif %}>
                                            {{ label }}
                                        </option>
                                    {% endfor %}
                                </select>
                                {% if field_errors.niveau_enseignement %}
                                    <span class="error-message">{{ field_errors.niveau_enseignement }}</span>
                                {% endif %}
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="matieres_secondaires">
                                <i class="fas fa-books"></i>
                                Matières secondaires (optionnel)
                            </label>
                            <select class="form-control" 
                                    id="matieres_secondaires" 
                                    name="matieres_secondaires" 
                                    multiple 
                                    size="5">
                                {% for matiere in matieres %}
                                    <option value="{{ matiere.id }}" 
                                            {% if matiere.id in form_data.matieres_secondaires %}selected{% endif %}>
                                        {{ matiere.nom }}
                                    </option>
                                {% endfor %}
                            </select>
                            <small class="form-text">Maintenez Ctrl (Cmd sur Mac) pour sélectionner plusieurs matières</small>
                        </div>
                    </div>

                    <!-- Informations système (lecture seule) -->
                    <div class="form-section">
                        <div class="section-header">
                            <div class="section-icon">
                                <i class="fas fa-info-circle"></i>
                            </div>
                            <h3 class="section-title">Informations système</h3>
                        </div>
                        
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">
                                    <i class="fas fa-id-badge"></i>
                                    Numéro d'employé
                                </span>
                                <span class="info-value">{{ professeur.numero_employe }}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">
                                    <i class="fas fa-calendar-plus"></i>
                                    Date d'embauche
                                </span>
                                <span class="info-value">{{ professeur.date_embauche|date:"d/m/Y" }}</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">
                                    <i class="fas fa-toggle-on"></i>
                                    Statut
                                </span>
                                <span class="info-value">
                                    <span class="badge {% if professeur.actif %}badge-success{% else %}badge-danger{% endif %}">
                                        {% if professeur.actif %}Actif{% else %}Inactif{% endif %}
                                    </span>
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Boutons d'action -->
                    <div class="form-actions">
                        <a href="{% url 'professeur:detail_professeur' professeur.id %}" class="btn btn-secondary">
                            <i class="fas fa-times"></i>
                            <span>Annuler</span>
                        </a>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i>
                            <span>Enregistrer les modifications</span>
                        </button>
                    </div>
                 </form>
             </div>
         </div>
    </div>

    <!-- Scripts -->
    <script src="{% static 'school_admin/js/directeur/ajouter_professeur.js' %}"></script>
</body>
</html>

